(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{1388:function(e,t,a){"use strict";a.r(t);var s=a(3082),n=a(1966);for(var o in n)"default"!==o&&function(e){a.d(t,e,function(){return n[e]})}(o);var r=a(0),l=a(2594),u=a.n(l),i=Object(r.a)(n.default,s.a,s.b,!1,null,null,null);"function"==typeof u.a&&u()(i),i.options.__file="index.vue",t.default=i.exports},1484:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setUserPrivs=t.getUserPrivs=t.changeUserPassword=t.assignUser=t.addUser=t.deleteAccessHost=t.addAccessHost=t.deleteUsers=t.getDatabase=t.uploadBackup=t.deleteDatabase=t.optimizeDatabase=t.checkDatabase=t.repairDatabase=t.getDatabases=t.createDatabase=t.getUsers=void 0;var s=o(a(6)),n=o(a(49));function o(e){return e&&e.__esModule?e:{default:e}}t.getUsers=n.default.get({id:"DB_USERS",url:"/CMD_DB_CREATE",domain:!0,after:function(e){return e.flow(e.toArray,e.filter(e.flow(e.getProp("text"),e.isEqual("..."),e.not)),e.mapArray(e.moveProp("label","text")))}}),t.createDatabase=n.default.post({url:"/CMD_DB",params:{action:"create"},domain:!0,schema:{name:n.default.REQUIRED_STRING,user:n.default.REQUIRED_STRING,passwd:n.default.OPTIONAL_STRING,passwd2:n.default.OPTIONAL_STRING,userlist:n.default.OPTIONAL_STRING},after:function(e){return e.mapProp("result",e.convert.toAppHtml)},updateTokens:!0}),t.getDatabases=n.default.get({id:"DATABASES",url:"/CMD_DB",domain:!0,schema:(0,s.default)({},n.default.PAGINATION),after:function(e){return e.mapProps({databases:e.toTable(e.mapArrayProps({nusers:e.convert.toAppNumber,size:e.convert.toAppNumber})),total_usage:e.convert.toAppNumber,dbs_select:e.toSelect})}});var r=n.default.select({url:"/CMD_DB",domain:!0,params:{json:!0}});t.repairDatabase=r.extend({params:{repair:!0}}),t.checkDatabase=r.extend({params:{check:!0}}),t.optimizeDatabase=r.extend({params:{optimize:!0}}),t.deleteDatabase=r.extend({params:{delete_db:!0},updateTokens:!0}),t.uploadBackup=n.default.post({url:"/CMD_DB",params:{action:"restore",method:"default"},domain:!0,schema:{name:n.default.REQUIRED_STRING,dbuser:n.default.REQUIRED_STRING,dbpass:n.default.REQUIRED_STRING,file:{type:File,required:!0}},before:function(e){return{file1:e.file,file:null}},transport:FormData}),t.getDatabase=n.default.get({id:"DB_VIEW",url:"/CMD_DB_VIEW",params:{page:1,ipp:9999},domain:!0,schema:{name:n.default.REQUIRED_STRING},after:function(e){return e.flow(e.project({hosts:"access_hosts",users:"db_users"}),e.mapValues(e.deleteProp("info")),e.mapProps({users:e.flow(e.toArray,e.mapArray(e.getProp("User"))),hosts:e.flow(e.toArray,e.mapArray(e.getProp("Access Hosts")))}))}}),t.deleteUsers=n.default.post({url:"/CMD_DB",method:"POST",params:{action:"deleteuser",delete:!0,json:!0},domain:!0,schema:{name:n.default.REQUIRED_STRING,select:n.default.ROWS}}),t.addAccessHost=n.default.post({url:"/CMD_DB_ACCESS",domain:!0,params:{add:!0,json:!0},schema:{name:n.default.REQUIRED_STRING,host:n.default.REQUIRED_STRING}}),t.deleteAccessHost=n.default.select({url:"/CMD_DB_ACCESS",domain:!0,params:{delete:!0,json:!0},schema:{name:n.default.REQUIRED_STRING}}),t.addUser=n.default.post({url:"/CMD_DB",domain:!0,params:{action:"createuser",json:!0},schema:{name:n.default.REQUIRED_STRING,passwd:n.default.REQUIRED_STRING,passwd2:n.default.REQUIRED_STRING}}),t.assignUser=n.default.post({url:"/CMD_DB",domain:!0,params:{action:"createuser",json:!0,passwd:"*****",passwd2:"*****"},schema:{name:n.default.REQUIRED_STRING,userlist:n.default.REQUIRED_STRING}}),t.changeUserPassword=n.default.post({url:"/CMD_DB",domain:!0,params:{action:"modifyuser",json:!0},schema:{name:n.default.REQUIRED_STRING,user:n.default.REQUIRED_STRING,passwd:n.default.REQUIRED_STRING,passwd2:n.default.REQUIRED_STRING}}),t.getUserPrivs=n.default.get({id:"DB_USER_PRIVS",url:"/CMD_DB_USER_PRIVS",domain:!0,schema:{name:n.default.REQUIRED_STRING,user:n.default.REQUIRED_STRING},after:function(e){return e.mapValues(e.isEqual("Y"))}}),t.setUserPrivs=n.default.post({url:"/CMD_DB_USER_PRIVS",domain:!0,params:{action:"save "},body:{name:n.default.REQUIRED_STRING,user:n.default.REQUIRED_STRING}})},1966:function(e,t,a){"use strict";a.r(t);var s=a(1967),n=a.n(s);for(var o in s)"default"!==o&&function(e){a.d(t,e,function(){return s[e]})}(o);t.default=n.a},1967:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=l(a(16)),n=l(a(17)),o=a(1484),r=l(a(2593));function l(e){return e&&e.__esModule?e:{default:e}}t.default={preload:o.getDatabases,api:[{command:o.getDatabases,bind:"db"}],commands:{getDatabases:o.getDatabases},components:{UploadBackupDialog:r.default},computed:{totalUsage:function(){return this.$options.filters.humanReadableSize(this.$api.db.total_usage_bytes)},databaseCount:function(){var e="user"===this.$state.app.user.level?"USER":"RESELLER";return Number(this.$state.app.tokens[e+"DATABASE"])}},data:function(){return{select:[]}},methods:{databaseRequest:function(e){var t=this;return(0,n.default)(s.default.mark(function a(){return s.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e({select:t.select});case 2:t.$refs.table.reloadTable(),t.$reset();case 4:case"end":return a.stop()}},a,t)}))()},repairDatabase:function(){this.databaseRequest(o.repairDatabase)},checkDatabase:function(){this.databaseRequest(o.checkDatabase)},optimizeDatabase:function(){this.databaseRequest(o.optimizeDatabase)},deleteDatabase:function(){this.databaseRequest(o.deleteDatabase),this.$store.dispatch("app/GET_TOKENS")}}}},1968:function(e,t,a){"use strict";a.r(t);var s=a(1969),n=a.n(s);for(var o in s)"default"!==o&&function(e){a.d(t,e,function(){return s[e]})}(o);t.default=n.a},1969:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r(a(16)),n=r(a(17)),o=a(1484);function r(e){return e&&e.__esModule?e:{default:e}}t.default={api:[{command:o.getDatabases,bind:"db"}],data:function(){return{name:"",file:null,method:"default",dbuser:"",dbpass:""}},computed:{dbList:function(){return this.$api.db.databases.rows.map(function(e){return e.database})}},methods:{uploadBackup:function(){var e=this;return(0,n.default)(s.default.mark(function t(){return s.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,o.uploadBackup)({name:e.name,file:e.file,method:e.method,dbuser:e.dbuser,dbpass:e.dbpass,domain:e.$domain});case 2:e.$emit("upload");case 3:case"end":return t.stop()}},t,e)}))()}}}},2593:function(e,t,a){"use strict";a.r(t);var s=a(3054),n=a(1968);for(var o in n)"default"!==o&&function(e){a.d(t,e,function(){return n[e]})}(o);var r=a(0),l=Object(r.a)(n.default,s.a,s.b,!1,null,null,null);l.options.__file="upload-backup-dialog.vue",t.default=l.exports},2594:function(e,t){},3054:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ui-dialog",{attrs:{id:"UPLOAD_BACKUP_DIALOG"},on:{"dialog:open":function(t){e.name=e.dbList[0]}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Upload Backup")]),e._v(" "),a("template",{slot:"content"},[a("ui-form-element",{attrs:{vertical:""}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Select Database")]),e._v(" "),a("input-select",{attrs:{slot:"content",options:e.dbList},slot:"content",model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),e._v(" "),a("ui-form-element",{attrs:{vertical:""}},[a("input-dropzone",{attrs:{slot:"content",showPreview:!1},slot:"content",model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1),e._v(" "),a("ui-form-element",{attrs:{vertical:""}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("Connection Method")]),e._v(" "),a("ui-grid",{attrs:{slot:"content",column:""},slot:"content"},[a("input-check",{attrs:{type:"radio",value:"default"},model:{value:e.method,callback:function(t){e.method=t},expression:"method"}},[a("translate",[e._v("Your current login information")])],1),e._v(" "),a("input-check",{attrs:{type:"radio",value:"custom"},model:{value:e.method,callback:function(t){e.method=t},expression:"method"}},[a("translate",[e._v("Custom username & password")])],1)],1)],1),e._v(" "),"custom"===e.method?[a("ui-form-element",{attrs:{vertical:"",group:"uploadBackup",validators:{required:!0}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Username\n                ")]),e._v(" "),a("input-text",{attrs:{slot:"content"},slot:"content",model:{value:e.dbuser,callback:function(t){e.dbuser=t},expression:"dbuser"}})],1),e._v(" "),a("ui-form-element",{attrs:{vertical:"",group:"uploadBackup",validators:{required:!0}}},[a("translate",{attrs:{slot:"title"},slot:"title"},[e._v("\n                    Password\n                ")]),e._v(" "),a("input-password",{attrs:{slot:"content"},slot:"content",model:{value:e.dbpass,callback:function(t){e.dbpass=t},expression:"dbpass"}})],1)]:e._e()],2),e._v(" "),a("ui-button",{attrs:{slot:"buttons",theme:"safe",validateGroup:"uploadBackup",disabled:!(e.file&&e.name)},on:{click:e.uploadBackup},slot:"buttons"},[a("translate",[e._v("Upload")])],1)],2)},n=[];a.d(t,"a",function(){return s}),a.d(t,"b",function(){return n})},3082:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("app-page",[a("template",{slot:"header:buttons"},[a("ui-tokens-conditional-button",{attrs:{link:"",theme:"primary",name:"user/database/create",token:"USERDATABASEMAX",usage:e.databaseCount}},[a("translate",[e._v("Create new Database")]),e._v(" "),a("translate",{attrs:{slot:"limitText"},slot:"limitText"},[e._v("Database limit reached")])],1),e._v(" "),a("ui-button",{attrs:{theme:"safe"},on:{click:function(t){e.$dialog("UPLOAD_BACKUP_DIALOG").open()}}},[a("translate",[e._v("Upload Backup")])],1)],1),e._v(" "),e.$_Client.isPhone?a("app-page-section",[a("ui-stats-summary",{attrs:{badges:[{label:e.$gettext("Database Count"),value:e.$api.db.rowsCount},{label:e.$gettext("Usage"),value:e.totalUsage}]}})],1):e._e(),e._v(" "),a("app-page-section",[a("ui-api-table",e._b({ref:"table",on:{"action:repair":e.repairDatabase,"action:check":e.checkDatabase,"action:optimize":e.optimizeDatabase,"action:del":function(t){e.$dialog("DELETE_ITEMS_DIALOG").open()}},scopedSlots:e._u([{key:"col:database",fn:function(t){var s=t.database;return a("ui-link",{attrs:{name:"user/database/view",params:{database:s}}},[e._v("\n                "+e._s(s)+"\n            ")])}},{key:"row:actions",fn:function(t){var s=t.database;return a("ui-button-link",{attrs:{theme:"light",size:"small",href:"/CMD_DB/"+s+".gz"}},[e.$_Client.isPhone?a("ui-icon",{attrs:{id:"download",size:"medium4"}}):a("translate",[e._v("Download")])],1)}}]),model:{value:e.select,callback:function(t){e.select=t},expression:"select"}},"ui-api-table",{command:e.$commands.getDatabases,rowID:"database",property:"databases",columns:{database:{label:e.$gettext("Database"),grow:!0},nusers:e.$gettext("Number of Users"),size:{label:e.$gettext("Size"),filter:"humanReadableSize"}},actions:{repair:e.$gettext("Repair"),check:e.$gettext("Check"),optimize:e.$gettext("Optimize"),del:e.$gettext("Delete")},verticalLayout:e.$_Client.isPhone},!1),[e.$_Client.isPhone?e._e():a("ui-stats-summary",{attrs:{slot:"buttons:before",badges:[{label:e.$gettext("Database Count"),value:e.databaseCount},{label:e.$gettext("Usage"),value:e.totalUsage}]},slot:"buttons:before"})],1)],1),e._v(" "),a("ui-dialog-delete-items",{attrs:{subject:e.$ngettext("database","databases",e.select.length)},on:{"click:confirm":e.deleteDatabase}}),e._v(" "),a("upload-backup-dialog",{on:{upload:e.$reloadApiTable}}),e._v(" "),a("ui-tokenized-link",{attrs:{slot:"bottom:links",bullet:"",href:"|WEBAPPS_SSL|://|HOSTNAME|/phpmyadmin"},slot:"bottom:links"},[a("translate",[e._v("phpMyAdmin")]),e._v(" "),e.databaseCount?e._e():a("translate",{attrs:{slot:"tooltip"},slot:"tooltip"},[e._v("\n            You won't be able to login to phpMyAdmin until you create a database\n        ")])],1)],2)},n=[];a.d(t,"a",function(){return s}),a.d(t,"b",function(){return n})}}]);